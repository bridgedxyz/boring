import React from "react";
import styled from "@emotion/styled";
import { Editor, BubbleMenu } from "@tiptap/react";

/* TODO: import icon somewhere else */
export function Menu(props: { editor: Editor | null }) {
  const { editor } = props;
  return (
    <>
      {editor && (
        <MenuWrapper
          className="bubble-menu"
          tippyOptions={{ duration: 100 }}
          editor={editor}
        >
          <Item>
            <Icon></Icon>
            <Link>Link</Link>
          </Item>
          <Divider />
          <Item
            onClick={() => editor.chain().focus().toggleBlockquote().run()}
            className={editor.isActive("quote") ? "is-active" : ""}
          >
            <Icon id="ic_text_quote">
              <path
                fill="rgb(83, 84, 85)"
                d="M 4.16015625 1.8359375 C 3.26171875 2.0052083283662796 2.630208343267441 2.65625 2.265625 3.7890625 C 2.0833333283662796 4.348958313465118 1.9921875 4.90234375 1.9921875 5.44921875 C 1.9921875 5.51432291418314 1.9921875 5.57291666790843 1.9921875 5.625 C 2.0052083330228925 5.6640625 2.0182291669771075 5.76171875 2.03125 5.91796875 L 4.16015625 5.91796875 L 4.16015625 10.17578125 L 0 10.17578125 L 0 6.25 C 0 4.322916626930237 0.3841145634651184 2.838541626930237 1.15234375 1.796875 C 1.9205729365348816 0.7552083730697632 2.923177123069763 0.15625 4.16015625 0 L 4.16015625 1.8359375 Z M 10.7421875 1.8359375 C 10.026041686534882 1.953125 9.47916665673256 2.3567708134651184 9.1015625 3.046875 C 8.73697915673256 3.7369791865348816 8.5546875 4.53125 8.5546875 5.4296875 C 8.5546875 5.5078125 8.5546875 5.5859375 8.5546875 5.6640625 C 8.567708333022892 5.7421875 8.587239583954215 5.82682291418314 8.61328125 5.91796875 L 10.7421875 5.91796875 L 10.7421875 10.17578125 L 6.5625 10.17578125 L 6.5625 6.25 C 6.5625 4.700520873069763 6.888020813465118 3.3203125 7.5390625 2.109375 C 8.190104186534882 0.8854166269302368 9.2578125 0.1822916716337204 10.7421875 0 L 10.7421875 1.8359375 Z"
              />
            </Icon>
          </Item>
          <Item
            onClick={() => editor.chain().focus().toggleBold().run()}
            className={editor.isActive("bold") ? "is-active" : ""}
          >
            <Icon id="ic_text_bold">
              <path
                fill="rgb(83, 84, 85)"
                d="M 0 13.090909957885742 L 0 0 L 5.2414774894714355 0 C 6.204545736312866 0 7.0078126192092896 0.14275550842285156 7.651278495788574 0.4282670021057129 C 8.294744729995728 0.7137784957885742 8.778409481048584 1.1100854873657227 9.102272987365723 1.6171875 C 9.426136493682861 2.1200287342071533 9.588068008422852 2.6995739936828613 9.588068008422852 3.3558239936828613 C 9.588068008422852 3.8671875 9.485796213150024 4.316761374473572 9.281250953674316 4.704545497894287 C 9.076705694198608 5.088068127632141 8.795455694198608 5.403409361839294 8.437500953674316 5.65056848526001 C 8.083807706832886 5.893466114997864 7.678977847099304 6.066051363945007 7.2230119705200195 6.168323993682861 L 7.2230119705200195 6.2961649894714355 C 7.721591353416443 6.317471742630005 8.18821096420288 6.458096742630005 8.622870445251465 6.7180399894714355 C 9.061790704727173 6.977983236312866 9.417613983154297 7.342329502105713 9.690340995788574 7.811079502105713 C 9.963068723678589 8.275568008422852 10.099432945251465 8.829544961452484 10.099432945251465 9.473011016845703 C 10.099432945251465 10.16761338710785 9.926847457885742 10.787642896175385 9.581676483154297 11.333097457885742 C 9.24076771736145 11.874290585517883 8.735795497894287 12.302558034658432 8.066761016845703 12.617898941040039 C 7.3977272510528564 12.933239847421646 6.573153853416443 13.090909957885742 5.5930399894714355 13.090909957885742 L 0 13.090909957885742 Z M 2.7677559852600098 10.828125 L 5.024147987365723 10.828125 C 5.795454740524292 10.828125 6.357954740524292 10.681107640266418 6.711647987365723 10.387073516845703 C 7.065341234207153 10.08877807855606 7.242188453674316 9.692472696304321 7.242188453674316 9.19815444946289 C 7.242188453674316 8.835938572883606 7.1548298597335815 8.51633596420288 6.980113983154297 8.239347457885742 C 6.805398106575012 7.962358593940735 6.556108355522156 7.745028257369995 6.232244491577148 7.587357997894287 C 5.912642121315002 7.4296873807907104 5.531250238418579 7.3508524894714355 5.08806848526001 7.3508524894714355 L 2.7677559852600098 7.3508524894714355 L 2.7677559852600098 10.828125 Z M 2.7677559852600098 5.477982997894287 L 4.8196024894714355 5.477982997894287 C 5.198863983154297 5.477982997894287 5.53551185131073 5.411931872367859 5.829545974731445 5.279829502105713 C 6.127841591835022 5.143465995788574 6.362216591835022 4.951704621315002 6.532670974731445 4.704545497894287 C 6.70738685131073 4.457386374473572 6.794744491577148 4.161222219467163 6.794744491577148 3.816051959991455 C 6.794744491577148 3.3430404663085938 6.626420617103577 2.9616479873657227 6.289772987365723 2.671875 C 5.957386493682861 2.3821020126342773 5.4843751192092896 2.237215518951416 4.870738983154297 2.237215518951416 L 2.7677559852600098 2.237215518951416 L 2.7677559852600098 5.477982997894287 Z"
              />
            </Icon>
          </Item>
          <Item
            onClick={() => editor.chain().focus().toggleItalic().run()}
            className={editor.isActive("italic") ? "is-active" : ""}
          >
            <Icon id="ic_text_italic">
              <path
                fill="rgb(83, 84, 85)"
                d="M 0 13.634233474731445 L 1.6363636255264282 3.816051959991455 L 3.5475857257843018 3.816051959991455 L 1.9112216234207153 13.634233474731445 L 0 13.634233474731445 Z M 2.9914774894714355 2.281961441040039 C 2.6590911746025085 2.281961441040039 2.3778411746025085 2.171165704727173 2.1477274894714355 1.9495744705200195 C 1.9218751192092896 1.7237224578857422 1.817471444606781 1.455256700515747 1.8345168828964233 1.144176959991455 C 1.8515625 0.8288357257843018 1.9836650490760803 0.5603694915771484 2.2308239936828613 0.3387789726257324 C 2.4779831171035767 0.11292624473571777 2.765625 0 3.09375 0 C 3.4261364936828613 0 3.7052560448646545 0.11292624473571777 3.931108236312866 0.3387789726257324 C 4.156960606575012 0.5603694915771484 4.263494610786438 0.8288357257843018 4.250710487365723 1.144176959991455 C 4.233664870262146 1.455256700515747 4.101562678813934 1.7237224578857422 3.8544037342071533 1.9495744705200195 C 3.611505925655365 2.171165704727173 3.3238638043403625 2.281961441040039 2.9914774894714355 2.281961441040039 Z"
              />
            </Icon>
          </Item>
          <Item
            onClick={() => editor.chain().focus().toggleUnderline().run()}
            className={editor.isActive("underline") ? "is-active" : ""}
          >
            <Icon id="ic_text_underline">
              <path
                fill="rgb(83, 84, 85)"
                d="M 11.838090896606445 0 L 9.85655689239502 0 L 9.85655689239502 8.450284957885742 C 9.85655689239502 9.042613983154297 9.726584434509277 9.568892478942871 9.466641426086426 10.029119491577148 C 9.210959434509277 10.489346504211426 8.840221405029297 10.851564407348633 8.354425430297852 11.115768432617188 C 7.872891426086426 11.375711441040039 7.29973840713501 11.505681991577148 6.634965896606445 11.505681991577148 C 5.974454402923584 11.505681991577148 5.403431415557861 11.375711441040039 4.921896934509277 11.115768432617188 C 4.44036340713501 10.851564407348633 4.067493915557861 10.489346504211426 3.8032894134521484 10.029119491577148 C 3.5433461666107178 9.568892478942871 3.413374662399292 9.042613983154297 3.413374662399292 8.450284957885742 L 3.413374662399292 0 L 1.438232421875 0 L 1.438232421875 8.610084533691406 C 1.438232421875 9.526277542114258 1.6534311771392822 10.338068008422852 2.083828926086426 11.045454025268555 C 2.5142266750335693 11.748579025268555 3.119340658187866 12.302557945251465 3.899170160293579 12.707387924194336 C 4.678999900817871 13.107955932617188 5.5909318923950195 13.308238983154297 6.634965896606445 13.308238983154297 C 7.683261394500732 13.308238983154297 8.597323417663574 13.107955932617188 9.377153396606445 12.707387924194336 C 10.156982421875 12.302557945251465 10.762096405029297 11.748579025268555 11.19249439239502 11.045454025268555 C 11.622892379760742 10.338068008422852 11.838090896606445 9.526277542114258 11.838090896606445 8.610084533691406 L 11.838090896606445 0 Z"
              />
            </Icon>
          </Item>
          <Item
            onClick={() => editor.chain().focus().toggleStrike().run()}
            className={editor.isActive("strike") ? "is-active" : ""}
          >
            <Icon id="ic_text_strike_through">
              <path
                fill="rgb(83, 84, 85)"
                d="M 7.234375 2.2116475105285645 C 7.72869348526001 2.544034004211426 8.009943008422852 3.012784004211426 8.078125 3.6178975105285645 L 9.982954978942871 3.6178975105285645 C 9.965909004211426 2.9147725105285645 9.761363983154297 2.292613387107849 9.369318962097168 1.751420259475708 C 8.977272987365723 1.2059662342071533 8.440340995788574 0.77769935131073 7.758522987365723 0.466619610786438 C 7.080965995788574 0.155539870262146 6.299005508422852 0 5.412642002105713 0 C 4.534801483154297 0 3.7464489936828613 0.15767061710357666 3.0475854873657227 0.47301185131073 C 2.348721742630005 0.7840908765792847 1.7947443723678589 1.220880389213562 1.3856534957885742 1.783380389213562 C 0.9765625596046448 2.345880389213562 0.7720171213150024 3.004261016845703 0.7720171213150024 3.7585225105285645 C 0.7720171213150024 4.670454978942871 1.0767046213150024 5.403409957885742 1.6860796213150024 5.9573869705200195 C 1.8072631359100342 6.066788673400879 1.936922550201416 6.170955181121826 2.0750577449798584 6.2698869705200195 L 0 6.2698869705200195 L 0 7.2698869705200195 L 4.37429141998291 7.2698869705200195 L 5.7258524894714355 7.638494491577148 C 6.1946024894714355 7.7620744705200195 6.614346504211426 7.904830455780029 6.985085487365723 8.06676197052002 C 7.360085487365723 8.228693962097168 7.65625 8.433238983154297 7.873579502105713 8.680397987365723 C 8.095170974731445 8.927556991577148 8.205965995788574 9.245028495788574 8.205965995788574 9.6328125 C 8.205965995788574 10.05894947052002 8.080255508422852 10.431818962097168 7.828835487365723 10.751420974731445 C 7.5774149894714355 11.06676197052002 7.232244491577148 11.313920974731445 6.793323516845703 11.492897987365723 C 6.3586649894714355 11.667613983154297 5.862216472625732 11.754972457885742 5.3039774894714355 11.754972457885742 C 4.796875 11.754972457885742 4.330255508422852 11.680397987365723 3.9041194915771484 11.53125 C 3.4822444915771484 11.377840995788574 3.1349432468414307 11.145597457885742 2.862215995788574 10.834517478942871 C 2.593750238418579 10.519176483154297 2.440340995788574 10.125000953674316 2.4019887447357178 9.651988983154297 L 0.42045462131500244 9.651988983154297 C 0.4630682170391083 10.440340995788574 0.6867898106575012 11.122159957885742 1.0916193723678589 11.697443962097168 C 1.4964489936828613 12.26846694946289 2.0568182468414307 12.709518432617188 2.7727274894714355 13.020597457885742 C 3.4886364936828613 13.331677436828613 4.3366475105285645 13.487215995788574 5.316761016845703 13.487215995788574 C 6.339488506317139 13.487215995788574 7.2109375 13.321022987365723 7.931107997894287 12.98863697052002 C 8.655540466308594 12.656250953674316 9.20738697052002 12.202415466308594 9.586647987365723 11.627131462097168 C 9.970170974731445 11.051847457885742 10.161932945251465 10.393465995788574 10.161932945251465 9.651988983154297 C 10.161932945251465 9.063920974731445 10.044745445251465 8.55894947052002 9.810370445251465 8.13707447052002 C 9.629799842834473 7.806028842926025 9.404622077941895 7.516966342926025 9.13483715057373 7.2698869705200195 L 11 7.2698869705200195 L 11 6.2698869705200195 L 7.378014087677002 6.2698869705200195 C 7.044731616973877 6.148618698120117 6.7177324295043945 6.048713684082031 6.397017002105713 5.970170974731445 L 5.118607997894287 5.637784481048584 C 4.862926006317139 5.573863983154297 4.596590995788574 5.492897987365723 4.3196024894714355 5.3948869705200195 C 4.042613506317139 5.292613983154297 3.782670497894287 5.166903495788574 3.5397729873657227 5.01775598526001 C 3.3011364936828613 4.864346981048584 3.1072444915771484 4.674715995788574 2.958096504211426 4.448863506317139 C 2.8132102489471436 4.223011016845703 2.740767478942871 3.954545497894287 2.740767478942871 3.6434664726257324 C 2.740767478942871 3.2727274894714355 2.8473012447357178 2.942471981048584 3.0603694915771484 2.6526994705200195 C 3.2776989936828613 2.3586649894714355 3.5823864936828613 2.128550887107849 3.9744319915771484 1.962357759475708 C 4.3664774894714355 1.7919037342071533 4.830965995788574 1.706676721572876 5.367897987365723 1.706676721572876 C 6.117897987365723 1.706676721572876 6.740056991577148 1.8750003576278687 7.234375 2.2116475105285645 Z"
              />
            </Icon>
          </Item>
        </MenuWrapper>
      )}
    </>
  );
}

// https://www.tiptap.dev/examples/menus
const MenuWrapper = styled(BubbleMenu)`
  display: flex;
  justify-content: flex-start;
  flex-direction: row;
  align-items: center;
  flex: none;
  box-shadow: 0px 9px 24px 0px rgba(15, 15, 15, 0.2),
    0px 3px 3px 6px rgba(15, 15, 15, 0.1),
    0px 6px 1px 1px rgba(15, 15, 15, 0.05);
  border: solid 1px rgb(237, 237, 236);
  border-radius: 4px;
  background-color: white;
  box-sizing: border-box;
`;

const Item = styled.button`
  display: flex;
  border-radius: 0px;
  justify-content: center;
  flex-direction: row;
  align-items: center;
  border: none;
  background: none;
  gap: 4px;
  align-self: stretch;
  box-sizing: border-box;
  padding: 10px 6px;
  flex-shrink: 0;
  background-color: transparent;

  &:hover,
  &.is-active {
    background-color: rgba(0, 0, 0, 0.2);
  }
`;

const Icon = styled.svg`
  width: 18px;
  height: 18px;
`;

const Link = styled.span`
  color: rgb(83, 84, 85);
  text-overflow: ellipsis;
  font-size: 18px;
  font-family: Inter, sans-serif;
  font-weight: 500;
  text-align: left;
`;

const Divider = styled.div`
  width: 42px;
  border-top: solid 1px rgb(237, 237, 236);
  align-self: stretch;
  flex-shrink: 0;
`;
